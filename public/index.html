<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8">
    <title>My Online Shop</title>
    <link rel="stylesheet" href="style.css">
  </head>
  <body>
    <header>
      <h1>My Online Shop</h1>
      <div id="user-info">
        <span id="username" style="display: none;"></span>
        <a id="user-page" class="nav-button" href="user.html" style="display: none;">My Account</a>
        <button id="logout" style="display: none;">Logout</button>
        <a id="sign-in" class="nav-button" href="signin.html">Sign In</a> / <a id="sign-up" class="nav-button" href="signup.html">Sign Up</a>
      </div>
    </header>
    <nav>
      <ul>
        <li><a href="">Home</a></li>
        <li><a href="#">About</a></li>
        <li><a href="#">Contact</a></li>
      </ul>
    </nav>
    <main>
      <section id="categories">
        <h2>Filter by Category</h2>
        <ul>
          <li><a class="category" data-category="Clothing">Clothing</a></li>
          <li><a class="category" data-category="Computer Components">Computer Components</a></li>
          <li><a class="category" data-category="Monitors">Monitors</a></li>
          <li><a class="category" data-category="Snacks">Snacks</a></li>
        </ul>
      </section>
      <section id="items">
        <h2>Items</h2>
        <ul id="item-list">
        </ul>
      </section>
    </main>
    <footer>
      <p>&copy; My Online Shop, 2023</p>
    </footer>
    <script>
      const itemList = document.getElementById('item-list');
      const categoryLinks = document.querySelectorAll('.category');
      const signIn = document.getElementById('sign-in');
      const signUp = document.getElementById('sign-up');
      const logout = document.getElementById('logout');
      const username = document.getElementById('username');
      
      
      function updateAuthUI() {
        const token = localStorage.getItem('token');
        if (token) {
          signIn.style.display = 'none';
          signUp.style.display = 'none';
          logout.style.display = 'inline';
          username.style.display = 'inline';
          userPage.style.display = 'inline';
          username.textContent = localStorage.getItem('username');
        } else {
          signIn.style.display = 'inline';
          signUp.style.display = 'inline';
          logout.style.display = 'none';
          username.style.display = 'none';
          userPage.style.display = 'none';
        }
      }

      logout.addEventListener('click', () => {
        localStorage.removeItem('token');
        localStorage.removeItem('username');
        updateAuthUI();
      });

      // Update UI on page load
      updateAuthUI();

      // Add click event listeners to category links
      categoryLinks.forEach((link) => {
        link.addEventListener('click', async () => {
          const category = link.dataset.category;
          const response = await fetch(`/items/category/${category}`);
          const items = await response.json();
          itemList.innerHTML = '';
          items.forEach((item) => {
            const li = document.createElement('li');
            const link = document.createElement('a');
            link.href = `item.html?id=${item._id}`;
            link.textContent = `${item.name} - ${item.price}`;
            li.appendChild(link);
            itemList.appendChild(li);
          });
        });
      });

      
    </script>
  </body>
</html>
